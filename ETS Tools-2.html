<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ETS Tools - Enterprise Technical Solutions</title>
    <meta name="description" content="A comprehensive suite of tools for EDI processing, file management, and team collaboration">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <style>
        body { 
            font-family: 'Inter', system-ui, -apple-system, sans-serif; 
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .highlight { background-color: #fef08a; padding: 0.125rem; border-radius: 0.25rem; }
        .dark .highlight { background-color: #a16207; }
        .gradient-primary { background: linear-gradient(to right, #3b82f6, #2563eb); }
        .gradient-emerald { background: linear-gradient(to right, #10b981, #059669); }
        .gradient-amber { background: linear-gradient(to right, #f59e0b, #d97706); }
        .gradient-purple { background: linear-gradient(to right, #8b5cf6, #7c3aed); }
        .gradient-indigo { background: linear-gradient(to right, #6366f1, #4f46e5); }
        .gradient-slate { background: linear-gradient(to right, #475569, #334155); }
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .btn-hover:hover { transform: translateY(-1px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .card-hover:hover { transform: translateY(-2px); box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
        .processing { animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .notification {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            z-index: 50;
            background: #10b981;
            color: white;
            padding: 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            transform: translateY(100%);
            opacity: 0;
            transition: all 0.3s ease;
        }
        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }
        .notification.error {
            background: #ef4444;
        }
        .team-btn {
            transition: all 0.2s ease;
            border: 1px solid #e5e7eb;
            background: white;
        }
        .team-btn:hover {
            border-color: #3b82f6;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
        }
        .search-input {
            transition: all 0.2s ease;
        }
        .search-input:focus {
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        /* Dark mode styles */
        .dark body {
            background-color: #0f172a !important;
            color: #f1f5f9 !important;
        }
        .dark .bg-white {
            background-color: #1e293b !important;
        }
        .dark .bg-gray-50 {
            background-color: #0f172a !important;
        }
        .dark .text-gray-900 {
            color: #f1f5f9 !important;
        }
        .dark .text-gray-600 {
            color: #94a3b8 !important;
        }
        .dark .text-gray-500 {
            color: #64748b !important;
        }
        .dark .text-gray-400 {
            color: #475569 !important;
        }
        .dark .border-gray-200 {
            border-color: #334155 !important;
        }
        .dark .border-gray-300 {
            border-color: #475569 !important;
        }
        .dark .bg-gray-50 {
            background-color: #1e293b !important;
        }
        .dark .team-btn {
            background-color: #1e293b !important;
            border-color: #475569 !important;
        }
        .dark .team-btn:hover {
            background-color: #334155 !important;
        }
        .dark .bg-blue-50 {
            background-color: #1e3a8a20 !important;
        }
        .dark .text-blue-900 {
            color: #93c5fd !important;
        }
        .dark .text-blue-700 {
            color: #60a5fa !important;
        }
        .dark .border-blue-200 {
            border-color: #1d4ed8 !important;
        }
        .dark input, .dark textarea {
            background-color: #334155 !important;
            color: #f1f5f9 !important;
            border-color: #475569 !important;
        }
        .dark input:focus, .dark textarea:focus {
            border-color: #3b82f6 !important;
        }
    </style>

    <script>
        // Dark mode configuration
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: {
                            DEFAULT: '#3b82f6',
                            50: '#eff6ff',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8'
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 text-gray-900 transition-colors duration-300">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b border-gray-200 sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center space-x-4">
                    <h1 class="text-2xl font-bold text-primary">ETS Tools</h1>
                    <nav class="hidden md:flex space-x-8">
                        <button onclick="scrollToSection('edi-formatter')" class="text-gray-600 hover:text-primary transition-colors">EDI Formatter</button>
                        <button onclick="scrollToSection('edi-comparator')" class="text-gray-600 hover:text-primary transition-colors">Comparator</button>
                        <button onclick="scrollToSection('idoc-utility')" class="text-gray-600 hover:text-primary transition-colors">IDOC Utility</button>
                        <button onclick="scrollToSection('url-encoder')" class="text-gray-600 hover:text-primary transition-colors">URL Tools</button>
                        <button onclick="scrollToSection('team-contacts')" class="text-gray-600 hover:text-primary transition-colors">Contacts</button>
                    </nav>
                </div>
                <button onclick="toggleTheme()" class="p-2 rounded-lg hover:bg-gray-100 transition-colors" title="Toggle dark mode">
                    <i data-lucide="moon" class="w-5 h-5 dark-icon"></i>
                    <i data-lucide="sun" class="w-5 h-5 light-icon hidden"></i>
                </button>
            </div>
        </div>
    </header>

    <main class="container-fluid py-4">
        <!-- Hero Section -->
        <div class="text-center mb-12 fade-in">
            <h2 class="text-4xl font-bold text-gray-900 mb-4">Enterprise Technical Solutions</h2>
            <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                A comprehensive suite of tools for EDI processing, file management, and team collaboration
            </p>
        </div>

        <!-- EDI Formatter -->
        <section id="edi-formatter" class="mb-5 fade-in">
            <div class="row">
                <div class="col-12">
                    <div class="gradient-primary text-white p-4 mb-3">
                        <h3 class="h4 mb-1 d-flex align-items-center">
                            <i data-lucide="file-code" class="me-3" style="width: 20px; height: 20px;"></i>
                            EDI File Formatter
                        </h3>
                        <p class="mb-0 text-blue-100">Convert raw EDI files to submittable format</p>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-12">
                    <div class="p-4">
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium mb-2">Upload EDI File</label>
                                <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-primary transition-colors">
                                    <input type="file" id="ediFile" accept=".txt,.edi" class="hidden" onchange="handleFileUpload(event)">
                                    <label for="ediFile" class="cursor-pointer">
                                        <i data-lucide="upload" class="w-8 h-8 text-gray-400 mb-2 mx-auto"></i>
                                        <span class="text-sm text-gray-600">Click to upload or drag and drop</span>
                                    </label>
                                </div>
                            </div>
                            <div class="text-center text-gray-500">or</div>
                            <div>
                                <label for="ediContent" class="block text-sm font-medium mb-2">Paste EDI Content</label>
                                <textarea id="ediContent" rows="15" class="w-full p-3 border border-gray-300 rounded-lg font-mono text-sm focus:ring-2 focus:ring-primary focus:border-transparent" placeholder="Paste your raw EDI content here..."></textarea>
                            </div>
                        </div>
                        <div class="space-y-4">
                            <div>
                                <label for="ediOutput" class="block text-sm font-medium mb-2">Formatted Output</label>
                                <textarea id="ediOutput" rows="15" readonly class="w-full p-3 border border-gray-300 rounded-lg font-mono text-sm bg-gray-50" placeholder="Formatted EDI content will appear here..."></textarea>
                            </div>
                            <div class="flex space-x-3">
                                <button onclick="convertEDI()" class="flex-1 bg-primary text-white px-4 py-2 rounded-lg font-medium btn-hover transition-all flex items-center justify-center">
                                    <i data-lucide="wand-2" class="mr-2 w-4 h-4"></i>
                                    <span id="formatBtnText">Format EDI</span>
                                </button>
                                <button onclick="copyToClipboard('ediOutput')" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                                    <i data-lucide="copy" class="w-4 h-4"></i>
                                </button>
                                <button onclick="downloadFile('ediOutput', 'formatted_edi.txt')" class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                                    <i data-lucide="download" class="w-4 h-4"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- EDI Comparator -->
        <section id="edi-comparator" class="mb-12 fade-in">
            <div class="bg-white overflow-hidden transition-all duration-300">
                <div class="px-6 py-4 gradient-emerald text-white">
                    <h3 class="text-xl font-semibold flex items-center">
                        <i data-lucide="git-compare" class="mr-3 w-5 h-5"></i>
                        EDI File Comparator
                    </h3>
                    <p class="text-emerald-100 mt-1">Compare two EDI files and highlight differences</p>
                </div>
                <div class="p-6">
                    <div class="grid md:grid-cols-2 gap-6 mb-6">
                        <div>
                            <label for="compareFile1" class="block text-sm font-medium mb-2">EDI File 1</label>
                            <textarea id="compareFile1" rows="25" class="w-full p-3 border border-gray-300 rounded-lg font-mono text-sm focus:ring-2 focus:ring-emerald-500 focus:border-transparent" placeholder="Paste EDI File 1 content here..."></textarea>
                        </div>
                        <div>
                            <label for="compareFile2" class="block text-sm font-medium mb-2">EDI File 2</label>
                            <textarea id="compareFile2" rows="25" class="w-full p-3 border border-gray-300 rounded-lg font-mono text-sm focus:ring-2 focus:ring-emerald-500 focus:border-transparent" placeholder="Paste EDI File 2 content here..."></textarea>
                        </div>
                    </div>
                    <button onclick="compareFiles()" class="w-full md:w-auto bg-emerald-600 hover:bg-emerald-700 text-white px-6 py-2 rounded-lg font-medium btn-hover transition-all flex items-center justify-center">
                        <i data-lucide="search" class="mr-2 w-4 h-4"></i>
                        <span id="compareBtnText">Compare Files</span>
                    </button>
                    
                    <div id="comparisonResults" class="mt-6 hidden">
                        <h4 class="text-lg font-semibold text-gray-900 mb-3">Differences Highlighted:</h4>
                        <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                            <pre id="differences" class="text-sm font-mono whitespace-pre-wrap overflow-x-auto"></pre>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- IDOC Utility -->
        <section id="idoc-utility" class="mb-12 fade-in">
            <div class="bg-white overflow-hidden transition-all duration-300">
                <div class="px-6 py-4 gradient-amber text-white">
                    <h3 class="text-xl font-semibold flex items-center">
                        <i data-lucide="rotate-ccw" class="mr-3 w-5 h-5"></i>
                        IDOC Reprocess Utility
                    </h3>
                    <p class="text-amber-100 mt-1">Reprocess stuck IDoc status events</p>
                </div>
                <div class="p-6">
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                        <div class="flex items-start">
                            <i data-lucide="info" class="text-blue-500 mt-1 mr-3 w-4 h-4 flex-shrink-0"></i>
                            <div>
                                <h4 class="font-medium text-blue-900">Information</h4>
                                <p class="text-sm text-blue-700 mt-1">
                                    If any IDoc status events get stuck in OLD or UPD status, this service can reprocess them by passing the IDoc number(s) as input.
                                </p>
                                <a href="https://chorus.apple.com/page/1966526" target="_blank" class="text-blue-600 text-sm underline hover:no-underline mt-2 inline-flex items-center">
                                    View Documentation <i data-lucide="external-link" class="ml-1 w-3 h-3"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    
                    <form onsubmit="handleIdocSubmit(event)" class="space-y-4">
                        <div>
                            <label for="iDocs" class="block text-sm font-medium mb-2">IDoc Numbers (one per line)</label>
                            <textarea id="iDocs" rows="6" required class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-amber-500 focus:border-transparent" placeholder="Enter IDoc numbers, one per line..."></textarea>
                        </div>
                        <button type="submit" class="bg-amber-600 hover:bg-amber-700 text-white px-6 py-2 rounded-lg font-medium btn-hover transition-all flex items-center">
                            <i data-lucide="send" class="mr-2 w-4 h-4"></i>
                            Reprocess IDocs
                        </button>
                    </form>
                </div>
            </div>
        </section>

        <!-- Reports and URL Tools Grid -->
        <div class="grid md:grid-cols-2 gap-6 mb-12">
            <!-- Tableau Reports -->
            <div class="bg-white overflow-hidden transition-all duration-300">
                <div class="px-6 py-4 gradient-purple text-white">
                    <h3 class="text-xl font-semibold flex items-center">
                        <i data-lucide="bar-chart-3" class="mr-3 w-5 h-5"></i>
                        Tableau Reports
                    </h3>
                    <p class="text-purple-100 mt-1">Auto alerts count by shift (IST)</p>
                </div>
                <div class="p-6">
                    <p class="text-gray-600 mb-4">
                        View real-time analytics for auto alerts based on current shift timings.
                    </p>
                    <a href="https://tableauanalytics.corp.apple.com/views/MouliSheet112sep2024/Dashboard1" target="_blank" class="inline-flex items-center bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                        <i data-lucide="external-link" class="mr-2 w-4 h-4"></i>
                        Open Dashboard
                    </a>
                </div>
            </div>

            <!-- URL Tools -->
            <div id="url-encoder" class="bg-white overflow-hidden transition-all duration-300">
                <div class="px-6 py-4 gradient-indigo text-white">
                    <h3 class="text-xl font-semibold flex items-center">
                        <i data-lucide="link" class="mr-3 w-5 h-5"></i>
                        URL Encoder/Decoder
                    </h3>
                    <p class="text-indigo-100 mt-1">For SSP GUID logs processing</p>
                </div>
                <div class="p-6">
                    <div class="space-y-4">
                        <div>
                            <label for="dencoder" class="block text-sm font-medium mb-2">URL Content</label>
                            <textarea id="dencoder" rows="12" class="w-full p-3 border border-gray-300 rounded-lg font-mono text-sm focus:ring-2 focus:ring-indigo-500 focus:border-transparent" placeholder="Enter URL content to encode or decode..."></textarea>
                        </div>
                        <div class="flex space-x-3">
                            <button onclick="decode()" class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-medium transition-colors flex items-center justify-center">
                                <i data-lucide="unlock" class="mr-2 w-4 h-4"></i>
                                Decode
                            </button>
                            <button onclick="encode()" class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-medium transition-colors flex items-center justify-center">
                                <i data-lucide="lock" class="mr-2 w-4 h-4"></i>
                                Encode
                            </button>
                        </div>
                        <div class="text-xs text-gray-500 flex items-center">
                            <i data-lucide="lightbulb" class="mr-1 w-3 h-3"></i>
                            Useful for converting encoded JavaScript URLs into readable format
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Team Contacts -->
        <section id="team-contacts" class="mb-12 fade-in">
            <div class="bg-white overflow-hidden transition-all duration-300">
                <div class="px-6 py-4 gradient-slate text-white">
                    <h3 class="text-xl font-semibold flex items-center">
                        <i data-lucide="users" class="mr-3 w-5 h-5"></i>
                        App Team Contacts
                    </h3>
                    <p class="text-slate-100 mt-1">Quick access to team Slack channels</p>
                </div>
                <div class="p-6">
                    <div class="mb-4">
                        <div class="relative">
                            <i data-lucide="search" class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"></i>
                            <input type="text" id="teamSearch" placeholder="Search teams..." class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg search-input focus:ring-2 focus:ring-primary focus:border-transparent" oninput="filterTeams()">
                        </div>
                    </div>
                    <div id="teamsList" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4"></div>
                    <div id="noTeamsFound" class="text-center py-8 text-gray-500 hidden">
                        No teams found matching your search
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="text-sm text-gray-600">
                    Â© 2024 ETS Tools - Enterprise Technical Solutions
                </div>
                <div class="text-sm text-gray-600 mt-2 md:mt-0">
                    Built with care for better productivity
                </div>
            </div>
        </div>
    </footer>

    <!-- Notification -->
    <div id="notification" class="notification">
        <div class="flex items-center space-x-3">
            <i data-lucide="check-circle" class="w-5 h-5 flex-shrink-0"></i>
            <span id="notificationText">Success!</span>
            <button onclick="hideNotification()" class="text-white hover:text-gray-200 transition-colors">
                <i data-lucide="x" class="w-4 h-4"></i>
            </button>
        </div>
    </div>

    <script>
        // Teams data
        const teams = [
            { name: 'EDI Team', url: 'https://apple.enterprise.slack.com/archives/C010VJ5SU20', icon: 'file-code', color: 'bg-blue-500' },
            { name: 'Integration Engineering Team', url: 'https://apple.enterprise.slack.com/archives/C019T9SRUP7', icon: 'settings', color: 'bg-green-500' },
            { name: 'E-Biz LISA Team', url: 'https://apple.enterprise.slack.com/archives/C06M9EJ11UZ', icon: 'shopping-cart', color: 'bg-purple-500' },
            { name: 'B2B CUSTOM Team', url: 'https://apple.enterprise.slack.com/archives/C06GN3M1MT3', icon: 'handshake', color: 'bg-orange-500' },
            { name: 'B2B Portal Team', url: 'https://apple.enterprise.slack.com/archives/GT7P5RT0T', icon: 'globe', color: 'bg-indigo-500' },
            { name: 'Visus Team (iHub archer)', url: 'https://apple.enterprise.slack.com/archives/C07320QVCDS', icon: 'eye', color: 'bg-pink-500' },
            { name: 'Splunk (platform services)', url: 'https://apple.enterprise.slack.com/archives/C0112DN6KUL', icon: 'search', color: 'bg-yellow-500' }
        ];

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            lucide.createIcons();
            renderTeams();
            initTheme();
        });

        // Theme management
        function initTheme() {
            const theme = localStorage.getItem('ets-theme') || 'light';
            if (theme === 'dark') {
                document.documentElement.classList.add('dark');
                updateThemeIcon(true);
            } else {
                document.documentElement.classList.remove('dark');
                updateThemeIcon(false);
            }
        }

        function toggleTheme() {
            const isDark = document.documentElement.classList.contains('dark');
            if (isDark) {
                document.documentElement.classList.remove('dark');
                localStorage.setItem('ets-theme', 'light');
                updateThemeIcon(false);
            } else {
                document.documentElement.classList.add('dark');
                localStorage.setItem('ets-theme', 'dark');
                updateThemeIcon(true);
            }
        }

        function updateThemeIcon(isDark) {
            const darkIcon = document.querySelector('.dark-icon');
            const lightIcon = document.querySelector('.light-icon');
            if (isDark) {
                darkIcon.classList.add('hidden');
                lightIcon.classList.remove('hidden');
            } else {
                darkIcon.classList.remove('hidden');
                lightIcon.classList.add('hidden');
            }
        }

        // Scroll to section
        function scrollToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        // Notification system
        function showNotification(message, isError = false) {
            const notification = document.getElementById('notification');
            const text = document.getElementById('notificationText');
            const icon = notification.querySelector('i[data-lucide]');
            
            text.textContent = message;
            
            if (isError) {
                notification.classList.add('error');
                icon.setAttribute('data-lucide', 'alert-circle');
            } else {
                notification.classList.remove('error');
                icon.setAttribute('data-lucide', 'check-circle');
            }
            
            lucide.createIcons();
            notification.classList.add('show');
            
            setTimeout(() => {
                hideNotification();
            }, 3000);
        }

        function hideNotification() {
            const notification = document.getElementById('notification');
            notification.classList.remove('show');
        }

        // EDI Formatter functions
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('ediContent').value = e.target.result;
                };
                reader.readAsText(file);
            }
        }

        async function convertEDI() {
            const ediContent = document.getElementById('ediContent').value;
            const ediOutput = document.getElementById('ediOutput');
            const btn = document.getElementById('formatBtnText');
            
            if (!ediContent.trim()) {
                showNotification('Please provide EDI content to format', true);
                return;
            }

            btn.textContent = 'Processing...';
            btn.parentElement.classList.add('processing');
            
            // Simulate processing time
            await new Promise(resolve => setTimeout(resolve, 500));
            
            const convertedContent = ediContent.replace(/~/g, '\n');
            ediOutput.value = convertedContent;
            
            btn.textContent = 'Format EDI';
            btn.parentElement.classList.remove('processing');
            
            showNotification('EDI file formatted successfully!');
        }

        // EDI Comparator functions
        async function compareFiles() {
            const file1Content = document.getElementById('compareFile1').value;
            const file2Content = document.getElementById('compareFile2').value;
            const btn = document.getElementById('compareBtnText');
            
            if (!file1Content.trim() || !file2Content.trim()) {
                showNotification('Please provide content in both files to compare', true);
                return;
            }

            btn.textContent = 'Comparing...';
            btn.parentElement.classList.add('processing');
            
            // Simulate processing time
            await new Promise(resolve => setTimeout(resolve, 800));

            const file1 = file1Content.split('\n');
            const file2 = file2Content.split('\n');
            let highlightedText = '';

            file1.forEach((line, index) => {
                if (index < file2.length) {
                    highlightedText += compareLine(line, file2[index]) + '\n';
                } else {
                    highlightedText += '<span class="highlight">' + escapeHTML(line) + '</span>\n';
                }
            });

            document.getElementById('differences').innerHTML = highlightedText;
            document.getElementById('comparisonResults').classList.remove('hidden');
            
            btn.textContent = 'Compare Files';
            btn.parentElement.classList.remove('processing');
            
            showNotification('Files compared successfully!');
        }

        function compareLine(line1, line2) {
            let result = '';
            const maxLength = Math.max(line1.length, line2.length);
            for (let i = 0; i < maxLength; i++) {
                const char1 = line1[i] || '';
                const char2 = line2[i] || '';
                if (char1 === char2) {
                    result += escapeHTML(char1);
                } else {
                    result += '<span class="highlight">' + escapeHTML(char1) + '</span>';
                }
            }
            return result;
        }

        function escapeHTML(text) {
            return text
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }

        // IDOC utility functions
        function handleIdocSubmit(event) {
            event.preventDefault();
            
            const idocNumbers = document.getElementById('iDocs').value;
            if (!idocNumbers.trim()) {
                showNotification('Please enter at least one IDoc number', true);
                return;
            }

            // Open the external service in a new tab
            const form = document.createElement('form');
            form.method = 'POST';
            form.action = 'https://vm-64d6b4c713fc3c591bd32152.us-east-1.compute.is.apple.com:19668/invoke/com.apple.b2b.iHubInfrastructure.reprocess.sap/republishSAPUpdateStatusEvent';
            form.target = '_blank';
            
            const input = document.createElement('input');
            input.type = 'hidden';
            input.name = 'iDocs';
            input.value = idocNumbers;
            
            form.appendChild(input);
            document.body.appendChild(form);
            form.submit();
            document.body.removeChild(form);
            
            showNotification('IDoc reprocess request has been submitted in a new window');
        }

        // URL encoder/decoder functions
        function encode() {
            const obj = document.getElementById('dencoder');
            const unencoded = obj.value;
            
            if (!unencoded.trim()) {
                showNotification('Please enter content to encode', true);
                return;
            }

            try {
                obj.value = encodeURIComponent(unencoded).replace(/'/g, "%27").replace(/"/g, "%22");
                showNotification('Content encoded successfully!');
            } catch (err) {
                showNotification('Failed to encode content', true);
            }
        }

        function decode() {
            const obj = document.getElementById('dencoder');
            const encoded = obj.value;
            
            if (!encoded.trim()) {
                showNotification('Please enter content to decode', true);
                return;
            }

            try {
                obj.value = decodeURIComponent(encoded.replace(/\+/g, " "));
                showNotification('Content decoded successfully!');
            } catch (err) {
                showNotification('Invalid encoded content', true);
            }
        }

        // Utility functions
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            const text = element.value;
            
            if (!text) {
                showNotification('No content to copy', true);
                return;
            }

            navigator.clipboard.writeText(text).then(() => {
                showNotification('Content copied to clipboard!');
            }, (err) => {
                showNotification('Failed to copy content', true);
            });
        }

        function downloadFile(elementId, filename) {
            const element = document.getElementById(elementId);
            const content = element.value;
            
            if (!content) {
                showNotification('No content to download', true);
                return;
            }

            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('File downloaded successfully!');
        }

        // Team contacts functions
        function renderTeams(filteredTeams = teams) {
            const teamsList = document.getElementById('teamsList');
            const noTeamsFound = document.getElementById('noTeamsFound');
            
            if (filteredTeams.length === 0) {
                teamsList.innerHTML = '';
                noTeamsFound.classList.remove('hidden');
                return;
            }
            
            noTeamsFound.classList.add('hidden');
            
            teamsList.innerHTML = filteredTeams.map(team => `
                <button onclick="openTeamChannel('${team.url}', '${team.name}')" class="team-btn p-4 text-left rounded-lg transition-all duration-200 hover:shadow-md">
                    <div class="flex items-center space-x-3 w-full">
                        <div class="${team.color} text-white p-2 rounded-lg">
                            <i data-lucide="${team.icon}" class="w-4 h-4"></i>
                        </div>
                        <div class="text-left">
                            <h4 class="font-medium text-gray-900">${team.name}</h4>
                            <p class="text-sm text-gray-500">Slack Channel</p>
                        </div>
                    </div>
                </button>
            `).join('');
            
            lucide.createIcons();
        }

        function filterTeams() {
            const searchQuery = document.getElementById('teamSearch').value.toLowerCase();
            const filteredTeams = teams.filter(team => 
                team.name.toLowerCase().includes(searchQuery)
            );
            renderTeams(filteredTeams);
        }

        function openTeamChannel(url, teamName) {
            window.open(url, '_blank', 'noopener,noreferrer');
            showNotification(`Redirecting to ${teamName} channel...`);
        }
    </script>
</body>
</html>